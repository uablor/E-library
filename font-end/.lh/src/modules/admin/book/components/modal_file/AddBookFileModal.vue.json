{
    "sourceFile": "src/modules/admin/book/components/modal_file/AddBookFileModal.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1748024285630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748025462662,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,87 +1,76 @@\n <template>\r\n-  <div v-if=\"show\" class=\"modal fade show d-block\" tabindex=\"-1\" role=\"dialog\">\r\n-    <div class=\"modal-dialog\" role=\"document\">\r\n-      <div class=\"modal-content p-3\">\r\n-        <div class=\"modal-header\">\r\n-          <h5 class=\"modal-title\">Add Book File</h5>\r\n-          <button type=\"button\" class=\"btn-close\" @click=\"emitClose\"></button>\r\n+  <div v-if=\"show\" class=\"fixed inset-0 z-50 bg-opacity-70 flex items-center justify-center\"\r\n+    style=\"background-color: rgba(0, 0, 0, 0.5);\">\r\n+    <div class=\"bg-white rounded-lg shadow-md w-full max-w-lg p-6 relative\">\r\n+      <h2 class=\"text-xl font-bold mb-4\">\r\n+        ເພີ່ມປະເພດປື້ມ\r\n+      </h2>\r\n+\r\n+      <button class=\"absolute top-2 right-2 text-gray-600 hover:text-red-500\" @click=\"$emit('close')\">✕</button>\r\n+\r\n+      <form @submit.prevent=\"handleSave\">\r\n+        <div class=\"mt-4\">\r\n+          <label class=\"block text-sm font-medium\">ຊື່ປະເພດ</label>\r\n+          <input v-model=\"localBookType.name\"\r\n+            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n         </div>\r\n \r\n-        <div class=\"modal-body\">\r\n-          <form @submit.prevent=\"submitForm\">\r\n-            <!-- Select Book -->\r\n-            <div class=\"mb-3\">\r\n-              <label class=\"form-label\">Select Book</label>\r\n-              <select class=\"form-select\" v-model=\"form.book_id\" required>\r\n-                <option value=\"\" disabled>Select a book</option>\r\n-                <option v-for=\"book in books\" :key=\"book.id\" :value=\"book.id\">\r\n-                  {{ book.title }}\r\n-                </option>\r\n-              </select>\r\n-            </div>\r\n+        <div class=\"mt-4\">\r\n+          <label class=\"block text-sm font-medium\">ລາຍລະອຽດ</label>\r\n+          <input v-model=\"localBookType.description\"\r\n+            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n+        </div>\r\n \r\n-            <!-- File Upload -->\r\n-            <div class=\"mb-3\">\r\n-              <label class=\"form-label\">Choose File</label>\r\n-              <input type=\"file\" class=\"form-control\" @change=\"handleFileChange\" required />\r\n-            </div>\r\n+        <div class=\"mt-4\">\r\n+          <label class=\"block text-sm font-medium\">ມື້ທີ່ເພີ່ມ</label>\r\n+          <input v-model=\"localBookType.created_at\" type=\"date\"\r\n+            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n+        </div>\r\n \r\n-            <div class=\"modal-footer\">\r\n-              <button type=\"submit\" class=\"btn btn-primary\">Add File</button>\r\n-              <button type=\"button\" class=\"btn btn-secondary\" @click=\"emitClose\">Cancel</button>\r\n-            </div>\r\n-          </form>\r\n+        <div class=\"mt-4\">\r\n+          <label class=\"block text-sm font-medium\">ມື້ທີ່ອັບເດດ</label>\r\n+          <input v-model=\"localBookType.updated_at\" type=\"date\"\r\n+            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n         </div>\r\n-      </div>\r\n+\r\n+        <div class=\"mt-6 flex justify-end space-x-3\">\r\n+          <button type=\"button\" @click=\"$emit('close')\" class=\"px-4 py-2 bg-gray-300 rounded\">ຍົກເລີກ</button>\r\n+          <button type=\"submit\" class=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\">ບັນທຶກ</button>\r\n+        </div>\r\n+      </form>\r\n     </div>\r\n   </div>\r\n </template>\r\n \r\n-<script setup>\r\n-import { ref, watch } from 'vue'\r\n-import axios from 'axios'\r\n+<script setup lang=\"ts\">\r\n+import { watch, reactive } from 'vue'\r\n \r\n const props = defineProps({\r\n   show: Boolean,\r\n-  books: {\r\n-    type: Array,\r\n-    required: true,\r\n-  },\r\n+  bookType: Object,\r\n })\r\n \r\n-const emit = defineEmits(['close', 'file-added'])\r\n+const emit = defineEmits(['close', 'save'])\r\n \r\n-const form = ref({\r\n-  book_id: '',\r\n-  file: null,\r\n+// const localBookType = reactive({})\r\n+const localBookType = reactive({\r\n+  name: '',\r\n+  description: '',\r\n+  created_at: '',\r\n+  updated_at: ''\r\n })\r\n+// Sync incoming bookType prop\r\n+watch(\r\n+  () => props.bookType,\r\n+  (newVal) => {\r\n+    Object.assign(localBookType, newVal || {})\r\n+  },\r\n+  { immediate: true }\r\n+)\r\n \r\n-const handleFileChange = (e) => {\r\n-  form.value.file = e.target.files[0]\r\n+function handleSave() {\r\n+  emit('save', { ...localBookType })\r\n }\r\n+</script>\r\n \r\n-const submitForm = async () => {\r\n-  try {\r\n-    const formData = new FormData()\r\n-    formData.append('book_id', form.value.book_id)\r\n-    formData.append('file', form.value.file)\r\n-\r\n-    const response = await axios.post('http://localhost:3000/api/book-files', formData, {\r\n-      headers: {\r\n-        'Content-Type': 'multipart/form-data',\r\n-      },\r\n-    })\r\n-\r\n-    alert('Book file added successfully')\r\n-    emit('file-added', response.data) // notify parent\r\n-    emitClose()\r\n-  } catch (error) {\r\n-    console.error('Error uploading book file:', error)\r\n-    alert('Failed to upload book file')\r\n-  }\r\n-}\r\n-\r\n-const emitClose = () => {\r\n-  emit('close')\r\n-}\r\n-</script>\r\n+<style scoped></style>\r\n"
                },
                {
                    "date": 1748025530405,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,32 +8,26 @@\n \r\n       <button class=\"absolute top-2 right-2 text-gray-600 hover:text-red-500\" @click=\"$emit('close')\">✕</button>\r\n \r\n       <form @submit.prevent=\"handleSave\">\r\n-        <div class=\"mt-4\">\r\n-          <label class=\"block text-sm font-medium\">ຊື່ປະເພດ</label>\r\n-          <input v-model=\"localBookType.name\"\r\n-            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n-        </div>\r\n+                    <!-- Select Book -->\r\n+            <div class=\"mb-3\">\r\n+              <label class=\"form-label\">Select Book</label>\r\n+              <select class=\"form-select\" v-model=\"form.book_id\" required>\r\n+                <option value=\"\" disabled>Select a book</option>\r\n+                <option v-for=\"book in books\" :key=\"book.id\" :value=\"book.id\">\r\n+                  {{ book.title }}\r\n+                </option>\r\n+              </select>\r\n+            </div>\r\n \r\n-        <div class=\"mt-4\">\r\n-          <label class=\"block text-sm font-medium\">ລາຍລະອຽດ</label>\r\n-          <input v-model=\"localBookType.description\"\r\n-            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n-        </div>\r\n+            <!-- File Upload -->\r\n+            <div class=\"mb-3\">\r\n+              <label class=\"form-label\">Choose File</label>\r\n+              <input type=\"file\" class=\"form-control\" @change=\"handleFileChange\" required />\r\n+            </div>\r\n \r\n-        <div class=\"mt-4\">\r\n-          <label class=\"block text-sm font-medium\">ມື້ທີ່ເພີ່ມ</label>\r\n-          <input v-model=\"localBookType.created_at\" type=\"date\"\r\n-            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n-        </div>\r\n \r\n-        <div class=\"mt-4\">\r\n-          <label class=\"block text-sm font-medium\">ມື້ທີ່ອັບເດດ</label>\r\n-          <input v-model=\"localBookType.updated_at\" type=\"date\"\r\n-            class=\"mt-1 block w-full rounded border border-gray-300 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n-        </div>\r\n-\r\n         <div class=\"mt-6 flex justify-end space-x-3\">\r\n           <button type=\"button\" @click=\"$emit('close')\" class=\"px-4 py-2 bg-gray-300 rounded\">ຍົກເລີກ</button>\r\n           <button type=\"submit\" class=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\">ບັນທຶກ</button>\r\n         </div>\r\n"
                },
                {
                    "date": 1748025573942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,10 +39,11 @@\n <script setup lang=\"ts\">\r\n import { watch, reactive } from 'vue'\r\n \r\n const props = defineProps({\r\n-  show: Boolean,\r\n-  bookType: Object,\r\n+   book_id: '',\r\n+  file: null,\r\n+\r\n })\r\n \r\n const emit = defineEmits(['close', 'save'])\r\n \r\n"
                },
                {
                    "date": 1748025590363,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,21 +39,18 @@\n <script setup lang=\"ts\">\r\n import { watch, reactive } from 'vue'\r\n \r\n const props = defineProps({\r\n-   book_id: '',\r\n-  file: null,\r\n-\r\n+  show: Boolean,\r\n+  bookType: Object,\r\n })\r\n \r\n const emit = defineEmits(['close', 'save'])\r\n \r\n // const localBookType = reactive({})\r\n-const localBookType = reactive({\r\n-  name: '',\r\n-  description: '',\r\n-  created_at: '',\r\n-  updated_at: ''\r\n+const form = ref({\r\n+  book_id: '',\r\n+  file: null,\r\n })\r\n // Sync incoming bookType prop\r\n watch(\r\n   () => props.bookType,\r\n"
                },
                {
                    "date": 1748025604489,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n   </div>\r\n </template>\r\n \r\n <script setup lang=\"ts\">\r\n-import { watch, reactive } from 'vue'\r\n+import { watch, ref } from 'vue'\r\n \r\n const props = defineProps({\r\n   show: Boolean,\r\n   bookType: Object,\r\n"
                },
                {
                    "date": 1748025612210,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n \r\n const emit = defineEmits(['close', 'save'])\r\n \r\n // const localBookType = reactive({})\r\n-const formBook = ref({\r\n+const formBookF = ref({\r\n   book_id: '',\r\n   file: null,\r\n })\r\n // Sync incoming bookType prop\r\n"
                },
                {
                    "date": 1748057693368,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,9 @@\n             required />\r\n         </div>\r\n           <div>\r\n           <label class=\"form-label\">ປະເພດປື້ມ</label>\r\n-          <select class=\"form-select w-full border border-gray-300 rounded p-2\" v- ></select>\r\n+          <select class=\"form-select w-full border border-gray-300 rounded p-2\" v-model=\"\" ></select>\r\n           </div>\r\n         <!-- Buttons -->\r\n         <div class=\"mt-6 flex justify-end space-x-3\">\r\n           <button type=\"button\" @click=\"$emit('close')\" class=\"px-4 py-2 bg-gray-300 rounded\">\r\n"
                }
            ],
            "date": 1748024285630,
            "name": "Commit-0",
            "content": "<template>\r\n  <div v-if=\"show\" class=\"modal fade show d-block\" tabindex=\"-1\" role=\"dialog\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content p-3\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\">Add Book File</h5>\r\n          <button type=\"button\" class=\"btn-close\" @click=\"emitClose\"></button>\r\n        </div>\r\n\r\n        <div class=\"modal-body\">\r\n          <form @submit.prevent=\"submitForm\">\r\n            <!-- Select Book -->\r\n            <div class=\"mb-3\">\r\n              <label class=\"form-label\">Select Book</label>\r\n              <select class=\"form-select\" v-model=\"form.book_id\" required>\r\n                <option value=\"\" disabled>Select a book</option>\r\n                <option v-for=\"book in books\" :key=\"book.id\" :value=\"book.id\">\r\n                  {{ book.title }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n\r\n            <!-- File Upload -->\r\n            <div class=\"mb-3\">\r\n              <label class=\"form-label\">Choose File</label>\r\n              <input type=\"file\" class=\"form-control\" @change=\"handleFileChange\" required />\r\n            </div>\r\n\r\n            <div class=\"modal-footer\">\r\n              <button type=\"submit\" class=\"btn btn-primary\">Add File</button>\r\n              <button type=\"button\" class=\"btn btn-secondary\" @click=\"emitClose\">Cancel</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\nimport axios from 'axios'\r\n\r\nconst props = defineProps({\r\n  show: Boolean,\r\n  books: {\r\n    type: Array,\r\n    required: true,\r\n  },\r\n})\r\n\r\nconst emit = defineEmits(['close', 'file-added'])\r\n\r\nconst form = ref({\r\n  book_id: '',\r\n  file: null,\r\n})\r\n\r\nconst handleFileChange = (e) => {\r\n  form.value.file = e.target.files[0]\r\n}\r\n\r\nconst submitForm = async () => {\r\n  try {\r\n    const formData = new FormData()\r\n    formData.append('book_id', form.value.book_id)\r\n    formData.append('file', form.value.file)\r\n\r\n    const response = await axios.post('http://localhost:3000/api/book-files', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    })\r\n\r\n    alert('Book file added successfully')\r\n    emit('file-added', response.data) // notify parent\r\n    emitClose()\r\n  } catch (error) {\r\n    console.error('Error uploading book file:', error)\r\n    alert('Failed to upload book file')\r\n  }\r\n}\r\n\r\nconst emitClose = () => {\r\n  emit('close')\r\n}\r\n</script>\r\n"
        }
    ]
}